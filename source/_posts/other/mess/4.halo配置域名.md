---
title: halo 配置域名
myPath: halo-domain
categories:
- other
- mess
tags: halo
date:
cover: ../images/other/21/4/23/halo.jpg
---
> 经过近一个月的域名备案，我的域名终于备案通过了！然后准备个人博客网站配置下的，最近再找房子然后觉得这个东东很简单就一直没搞！上周末找到房子租了下来，还是要把这些东西搞一下，然后配置的过程中发现还是有些坑在这里面，所以还是记录如下：

题外话：阿里云，在你域名备案期间，你备案用了多少时间，阿里云会延长对应的使用时间，不得不说这点还是很人性化的，就冲这一点，阿里云我还会继续用下去！

### halo配置域名解析

参考官网的来：<a href="https://halo.run/archives/install-reverse-proxy.html" target="_blank"> 配置域名访问</a>

其实也就下面几步：

```sheel
# 查看是否安装nginx
ps  -ef | grep nginx

# 未安装，添加 Nginx 源
sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm

# 未安装，安装 Nginx
sudo yum install -y nginx

# 未安装，启动 Nginx
sudo systemctl start nginx.service

# 未安装，设置开机自启 Nginx
sudo systemctl enable nginx.service

# 下载 Halo 官方的 Nginx 配置模板
curl -o /etc/nginx/conf.d/halo.conf --create-dirs https://dl.halo.run/config/nginx.conf

# 使用 vim 编辑 halo.conf
vim /etc/nginx/conf.d/halo.conf
```

打开后，我们需要修改`server_name` 和`proxy_pass` 即可，***不要修改默认监听端口，不要修改默认监听端口,不要修改默认监听端口***;

傻傻的我给修改为成我博客的配置的端口了；导致后面有坑，我们后面再说！

### 访问不了，问题分析

本以为，就这样就ojbk!日，咋还是不行...别急，我们慢慢来分析一波，其实急的我直冒汗

问题分析：在阿里云上买的域名，为啥配置后不能直接访问域名呢？

1. 首先ping 对应的ip 确认是可以访问的，证明对应的ip 是公网可以访问的且防火墙是开的，访问链路没问题；
2. 那么ping 对应的域名，发现域名ping 不通！

我擦，什么情况；回想下我们本地，配置域名是怎么搞的？是不是要配置对应的host 映射呢？那么阿里云买了域名后，哪里配置这个host域名映射呢？

好了，不卖关子了；买了阿里云后要配置域名解析的，哥哥！好吧，我也是踩了坑才知道，那这个域名解析其实就是我们本地配置域名访问的时候配置的host 映射关系，实际还是通过ip 来访问的，只不过nginx配置了代理，就可以通过对于的域名访问啦；

### 配置域名解析

![](https://s1.ax1x.com/2020/04/20/JlhRkF.png)

点击`阿里云DNS>`进入DNS控制台，选择对应的域名进行`解析设置`

![](https://s1.ax1x.com/2020/04/20/Jl5929.png)

如果不清楚怎么设置右上角有`？如何设置解析`，可以了解解决；

哈哈，也可以直接点击新手引导添加我们的ip 即可；

配置好后，我们在ping 下我们的域名，你会发现域名已经可以ping 通了

然后这里我使用域名访问，我擦咋还是访问不了，直接到Centos 首页了，必须加上端口号才能访问自己的博客；呃呃呃，这咋玩的！域名加端口访问也不是不可以，只是好挫的有木有，啥时候看到网站把端口给暴露出来了。。。不行，肯定是哪里配置错了！然后我就我发现我手贱把默认80端口给改成我自己的博客端口了，改过来后再reload后通过域名访问就ok了！

注：域名配置好了，对应的halo后台管理中的域名也别忘了配置哈，再对应的系统->博客设置中！

### 其他问题
时隔一天，猛然想起给这个主题的博主自推了友链。没给头像链接，赶紧过去看看，发现细心的大大已经加上了。。。然后我赶紧打开个人博客看看，看看图片地址。我去咋还是ip的形式访问的呢？这怎么行！
然后就新增篇文章查看，发现链接变成域名访问了，可是已经发布的博客还是ip访问的...那能怎么办呢？一个个的改呗，笑try(暂时没想到其他好的办法)

> 哎，说那么多，其实还是对nginx 的配置的原理了解的不够透彻，我们项目中基本就是改几个配置，多的还是没深入了解！后面了解学习后再来一篇nginx配置篇学习博客吧！哦啦，就先酱紫吧!